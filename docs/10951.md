# 升级 Umbraco

> 原文:[https://dev.to/mozzydev/upgrading-umbraco-4bgo](https://dev.to/mozzydev/upgrading-umbraco-4bgo)

在最近的一个项目中，我的任务是将一个网站从 Umbraco 的 v4 升级到最新最好的版本。这有几个原因，它不会没有挑战，但我认为最终结果肯定是值得的。

 <sub>注意:作为参考，我主要是围绕升级现有的 Umbraco 实现，而不是迁移到另一个实例。此外，特别是围绕主要版本，因为补丁更新很少导致任何问题，在可能的情况下，您应该尽可能保持最新。
T3】</sub>

### [](#why-upgrade)为什么要升级？

嗯，谁不想利用更新的用户界面和改进的底层架构呢？HQ 团队(以及社区中的其他人)一直在做许多事情，在技术世界中，许多事情可以在相对较短的时间内发生变化。

*   完全重新设计
*   以移动格式工作
*   更好的编辑体验
*   新服务层
*   更好的性能
*   对最新技术的更大支持
*   包裹！
*   等等。

另一方面，网站过去的构建方式可能存在问题(想想 WebForms/XSLT ),这使得升级变得困难，或者只是太费时间而无法回到升级的道路上来使用 Umbraco 的**最佳版本**。这些选择在很大程度上取决于客户，需要进行一些交流。显然，我们都希望工作到最新版本，并在一个共同的操场上，但有时其他事情会阻碍我们采取这些步骤。

好消息是，通过一些计划和一点点毅力和知识，它实际上并不像你想象的那么令人生畏。我听说过很多次，对一个 3-5 年前建立的网站进行升级的概念最好是对内容进行彻底的重写和返工，包括新的设计。虽然这可能是您经常走的路，但有时迁移一堆内容，然后考虑所有相关的变化并不完全可行，也不是最佳选择。对于较大的网站，这种情况肯定会发生。

### [](#whats-the-process)有什么流程？

从 7.3 开始，很大程度上 Umbraco 升级可以通过 NuGet 完成，不需要太多额外的工作。这都是由添加的迁移脚本处理的，从现在开始，每个次要版本都包含这些脚本(甚至可以追溯到 [FourOneZero](https://github.com/umbraco/Umbraco-CMS/tree/dev-v7/src/Umbraco.Core/Persistence/Migrations/Upgrades/TargetVersionFourOneZero) )。当您将所有文件更新到最新版本时，Umbraco 将对数据库进行检查，如果发现需要更新，则会提示您通过安装程序升级数据库。点击按钮，等待直到您看到新的 Umbraco 用户界面。

但是事情可能没有那么顺利，有时安装程序可能会失败，或者它会报告有不兼容的数据类型。那你会怎么做？当谈到数据类型时，我发现您可以将它们映射到较新的对应项，或者在完成基本升级后简单地记下并更新它们。记下之前有什么，之后想要什么。至于当它失败时，找到错误并在论坛上寻找支持，或者在追踪器上放置一个问题。每一个这样做的人，都会帮助 Umbraco 去帮助其他人，让这个过程对所有人都更好。

在这一点上，我主要指的是让 Umbraco 在后台工作并拥有一个工作的 CMS 的概念。我们仍然需要看看实际运行网站的代码。上面我提到你可能使用旧的技术或者你可能使用不再兼容的包/数据类型。在弄清楚这些事情之前的准备工作是很重要的，这将提供一个你现在所处的位置和你想要的位置之间的比较。我发现从数据库中导出文档类型、模板和宏是一个特别有用的练习。很有可能没有太多的定制实现，实际上一旦你完成了数据库方面的工作，Umbraco 无需任何重大调整就能工作。

您可能想了解的其他一些事情:

*   更新图标
*   更新数据类型(如果需要)
*   找出包的最佳用途
*   评估文档类型的使用(可以改变它们并分类到文件夹中)
*   评估宏的使用(它可能只是一个剃刀部分吗？)
*   检查内容

为 MVC/Razor 切换 WebForms/XSLT 可能是一项耗时的任务，但最终证明这是一个修改以前的一些方法并更新到新技术的机会。这也是认识到 XSLT 相当讨厌的一种很好的方式，在摆脱了它之后，您可以松一口气，因为另一个 Umbraco 站点已经从不太遥远的过去走了出来。当然是打个比方。不幸的是，当涉及到内容结构时，您将不能切换太多，但是您可以将一些旧的包升级到它们的等效 v7 包。例如，嵌入内容现在变成了嵌套内容，每个人都很高兴。

### [](#conclusion)结论

所以，你有一个旧网站，并正在考虑采取的飞跃。评估你的选择，弄清楚什么是重要的，以及这项工作的规模有多大。进行备份和比较。拥抱变化，享受 Umbraco 的新世界。你知道这是一个很好的 CMS。