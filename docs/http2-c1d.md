# HTTP/2 不是在任何情况下都有望提高速度的万能技术

> 原文：<https://dev.to/ykzts/http2-c1d>

最近，HTTP/2 看起来突然出现了流行的征兆。 因为我认为不用未提及的技术，而且不用的技术与不存在的东西同义，所以并不是坏事，但是看起来好像忽视了本来在使用 HTTP/2 时应该注意的点，所以有必要深思一下吧。

HTTP/2 是将多个请求合并为一个连接的通信标准，确实能够消除传统的基于 HTTP/1.1 的通信中存在的明显的速度延迟的原因。 但是，HTTP/2 在现在的安装状况下，要求 TLS 配置在上层，是 HTTPS。 由于 HTTPS 不仅要进行加密和解密的处理，还要进行证书的确认，所以速度会比 HTTP 低。 如果是只有几十个左右的连接的网页，与通过使用 HTTP/2 得到的速度提高相比，使用 HTTPS 得到的速度降低会更大，结果是速度降低。 我认为，基于 HTTP/2 的受益仅限于贴有数百张图像的网页、反复通过 Ajax 获取动态信息，在短时间内经常持续发生几个通信的网络 APP 应用。 在以文档为主体，只有几张图片的网页上，非但没有意义，反而只会带来不良影响。

另外，如果不是基于同一主机名的通信，就不会带来基于 HTTP/2 的速度提高的好处。 严格地说，可以通过在同一证书中指定别名或在公用名中使用通配符来使用多个主机名。 但是，主机名受到限制这一点没有变化。 例如，使用亚马逊 s 3 等存储服务，进行图像文件等的发送的情况下，HTTP/2 完全没有效果。

然后，由于 HTTP/2 在现状下必须是以 HTTPS 进行通信，因此，在此前由 HTTP 提供的情况下，URI 会发生变化。 通过使用 301 Moved Permanently 和`Location`标头进行传输，虽然可以从现有的 URI 进行引导，但是[酷酷的 URI 不变，](https://www.kanzaki.com/docs/Style/URI)这一 web 的基本想法变得行不通了。 另外，如果有一天想停止使用 HTTP/2 的时候，这次也必须一直维持 HTTPS。 HTTP 的维持并不是一件麻烦的事情，但 HTTPS 的维持也与证书有关，多少有些麻烦。 考虑到今后的事情，在不能断定一定有必要的情况下应该避免。

现在使用较多的 web 服务器是 Apache 和 nginx 两个吧。 Apache 中存在用于支持 HTTP/2 的模块，另外，nginx 中标准具备 HTTP/2 的支持。 无论哪种情况，都可以简单地实施 HTTP/2 的应对。 因此，可能有人会考虑在尝试其他提高速度的方法之前轻松地使用 HTTP/2。 但是，通过 HTTP/2 提高速度的情况非常有限。 要认真考虑自己提供的东西是什么，在 HTTP/2 不合适的情况下，应该使用合适的其他手段。

例如，在使用 WordPress 的情况下，PHP 自身的速度迟缓和使用 MySQL 的信息授受产生的速度降低被认为比通信瓶颈更致命。 导入 APC 和使用 memcached 等进行适当的缓存对提高速度更有效吧。 另外，如果是经常使用 JavaScript 进行动态操作的网页的话，通过恰当地进行 DOM 操作，可以避免处理变慢的情况，观众感受到的速度的提高将会非常大。 现在的 JavaScript 有很多实现通过 JIT 可以高速运行，但 DOM 操作仍然非常慢。 如果不进行恰当的记述，其积累会导致不可忽视的致命的速度延迟。 存在几个比使用 HTTP/2 更有效、更现实的方法。

尽管如此，需要进行机密性很高的信息交换，本来就不会考虑用 HTTP 提供，在需要设为 HTTPS 的情况下，即使使用 HTTP/2 也没有损失。 不仅限于 HTTP/2，这样的最新技术在深思熟虑的基础上，每次都要进行适合合适的选择，这一点很重要。