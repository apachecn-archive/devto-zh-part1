# 你怎么知道你的代码是坏的？

> 原文：<https://dev.to/bob/how-do-you-know-your-code-is-bad>

前几天，我看了罗伯特·马丁的视频，他提到了识别错误代码的三个症状。我非常同意。

### 1。刚性代码

如果你不能在不改变其他模块的情况下改变一段代码，那么你的代码就是僵化的，这些模块与你试图改变的代码无关。

> 刚性代码是这样一种代码，它的依赖关系向很多方向蔓延，以至于你不能在不改变周围所有东西的情况下做出一个孤立的改变。罗伯特·马丁

例如，您试图更改数据层中的一些底层细节，突然在为您的视图进行格式化的类中出现了一个编译错误。

如果您经常发现自己接触到项目中几乎所有的模块，那么每当您在单个类中进行更改时，这可能意味着代码僵化的症状。

### 2。脆弱代码

脆弱的代码比严格的代码更糟糕。至少我们在严格的代码中得到一个编译错误。

在脆弱代码中，如果您在一个模块中更改一小段代码，就会破坏一个完全不同的模块中完全不同的特性。并且在开发过程中没有简单的方法来发现这些错误。

> 脆弱的代码会以你无法预测的怪异方式崩溃。罗伯特·马丁

如果你经常收到客户的投诉，说某个特性坏了，那么每当你为一个完全不同的用例推出一个补丁时，这可能意味着你的代码是脆弱的。

### 3。不可重用代码

不可重用代码，顾名思义，就是不能重用的代码。

例如，您可能希望在您的项目中实现一个功能，该功能与您的同事为另一个项目所做的功能相同。但是你不能轻易地重用这个项目中的代码，因为这些代码依赖于他们项目中其他一些不相关的特性，而这些特性又依赖于一些你不希望出现在你的项目中的框架或数据库系统。您最好为该特性编写自己的实现。

这就是著名的[大猩猩香蕉问题](https://www.johndcook.com/blog/2011/07/19/you-wanted-banana/):

> 你想要一根香蕉，但你得到的是一只大猩猩拿着一根香蕉，整个丛林都是香蕉。—乔·阿姆斯特朗

# 如何才能避免这 3 个瑕疵？

当你写代码时，问自己这些问题:

1.  这个代码是不是太死板了？以后有没有可能改变这个模块的内部，而不触及其他模块和其他层的代码？

2.  这个代码是不是太脆弱了？为将来的任何变化找到所有要重构的地方会很难吗？

3.  这个特性应该是可重用的吗？如果是，这段代码是否依赖于任何可以避免的不需要的模块或框架？

如果我们仔细观察，以上三个问题的共同点是耦合。这些模块以不希望的方式相互依赖，这导致代码杂乱无章。

代码应该在模块和层之间解耦。高级策略和抽象不应该依赖于低级细节。在需要的地方反转模块的依赖关系。编写只做一件事并且[只有一个理由改变](https://8thlight.com/blog/uncle-bob/2014/05/08/SingleReponsibilityPrinciple.html)的类。

> 好的代码应该解释它在做什么。读起来应该没意思。一切都非常明显。这是很好的代码。罗伯特·马丁

*也发表在我的[媒体刊物](https://medium.com/thoughts-overflow/how-do-you-know-your-code-is-bad-c76359be9c3b)上。*