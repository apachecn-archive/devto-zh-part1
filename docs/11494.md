# 使用 Google App Engine 发送推送通知

> 原文:[https://dev . to/stipegrbic/sending-push-notifications-with-Google-app-engine-50io](https://dev.to/stipegrbic/sending-push-notifications-with-google-app-engine-50io)

当我为本地天气预报开发 Windows Phone 应用程序时，很自然地实现了推送通知——因为你知道用户手动检查是否有新的天气信息是多么困难。所以，问题是如何做到——简单、快速且免费？

### [](#solution)解

谷歌有一项名为 App Engine 的服务，可以让你用 Java 或 Python 制作网络应用，并免费托管在他们的服务器上。为了让每个人都可以免费使用它，他们不得不做很多限制，但是对于这个目的的应用来说，没有太多的障碍可以让它工作。

### [](#problems)问题

我不会在这里写构建 web 应用程序，而是写我遇到的一个问题。所以，一旦我把它做出来并投入使用，在第一个问题出现之前，它就可以正常工作了——发送通知的请求花费了太多的时间。谷歌应用引擎在沙盒环境中运行应用程序，这意味着你在那里没有太多的自由。有问题的约束是每个请求在终止前只有 60 秒的时间来完成。我知道发送一个通知通常不需要太长时间，只需要几分之一秒，我想即使有成千上万的用户，这也不是问题。但是，当我查看日志时，我发现有时需要几秒钟，然后就失败了。这时 URL 不可用，通知无法发送。你对此无能为力，因为微软负责向用户发送通知。但是你可以做一些事情来解决这个问题:

*   当用户的通知 URL 发生变化时，删除旧的 URL。不仅因为它将清除不必要的数据，而且它还将使发送通知更快，因为你的服务器不会试图发送通知到一个旧的网址。

*   使用异步请求。所有对外部资源的请求都通过 URL 获取服务，但它允许您异步获取 URL。当调用成千上万个通知 URL 时，您应该使用该功能，不要阻塞您的线程。需要记住的一点是，一个请求只有 60 秒的时间来完成，没有一个线程能比启动它的请求活得更久。

*   不要删除失败过一次的网址。我认为失败的网址可以安全删除，因为它不起作用，可能是一些旧的网址。这是错误的，因为它导致大量活跃的网址被删除，用户无法收到通知，直到他们的网址改变。

总的来说，谷歌应用引擎非常适合这个目的。它使用简单、可靠且免费，但它有很多限制，这可能会给其他应用程序带来问题。这是可以理解的，因为即使是谷歌也没有无限的资源，当你免费使用一些东西时，你实际上没有权利抱怨它:)