# 如何用 React 绘制猫头鹰:一个迁徙的故事

> 原文:[https://dev . to/sparkpost/how-to-draw-a-owl-react-a-migration-story-537](https://dev.to/sparkpost/how-to-draw-an-owl-with-react-a-migration-story-537)

几个月前，[我写了我们的冒险经历](https://www.sparkpost.com/blog/react-angular-edition/)用 React 建造[一个全新的项目](https://tools.sparkpost.com/spf/inspector)。我们现有的 SparkPost 应用程序是许多个月前在一个叫做 AngularJS 的古老框架中构建的。在之前的那篇文章中，我说(我引用一下)，“那么那个 50，000 行的 Angular 应用程序呢？我们不会迁移它来做出反应，至少不会直接迁移。”好吧，我们把它移植过来。直接。

这并不是说我撒谎，而是说我是自己崇高理想主义的受害者。那篇文章发表后不久，我开始着手改进 Angular 应用程序的计划。经过近两个星期的努力才让鲍尔退出这个项目，我立即开始重新思考我所有的理想和人生选择。我试过一件事，很难。是时候抛弃理想了。

### [](#the-pivot)枢轴

严肃地说，我们考虑了一些其他疯狂的想法，比如在 Angular 内部编写 React，或者一次迁移一页。最终，我们意识到，在一个全新的框架中重建我们整个应用程序的最快和最安全的方法就是做我公开嘲笑的事情:直接迁移，即并行重建。最大的问题是 SparkPost 会支持这个伟大的想法吗？

### [](#the-pitch)音高

在我继续之前，我应该非常清楚地解释一些事情。在工程领域，从头开始完全重写现有应用程序的机会很少。如果你从这篇文章中想到，“我想完全重写我们的应用程序！”，你应该知道你将需要一个非常好的推销(和一些愿意为你争取大量时间的灵活的决策者)。

也就是说，有机会重新思考和重建你的整个用户界面作为一个单一的，一致的单元，而不是继续在一个越来越摇摇欲坠的房子上堆叠更多的卡，这是巨大的价值。SparkPost 参与了重建工作，我们开始着手一项计划。

### [](#the-plan)计划

那么，如何重建整个 web 应用程序呢？

步骤 1:分类并构建可重用组件、设计工具和关键特性(如身份验证)的坚实基础。

第二步:[画出其余的【审查】猫头鹰](http://knowyourmeme.com/memes/how-to-draw-an-owl)。

老实说，我们最初的计划只是稍微充实了一点，而且我们在这个过程中做了很多改变和调整。这里有一些我们最满意的作品，它们帮助我们为最大限度的画猫头鹰做准备。

**重点:**我们整个应用团队一直是“全栈”，从后端弹到前端再弹回来。随着我们的成长，我们认识到需要一个核心团队，他们可以完全专注于像前端重建这样的项目。这种专注有助于我们最大限度地提高效率，尽可能创造最佳基础。它还允许我们成为团队其他成员的桥梁，讨论这个新应用程序是如何构建的，以及最终他们如何做出贡献。

**模块化设计** : Jon Ambas，我们的前端工程师和设计负责人(也是我在构思这个计划早期的主要合作伙伴)，一直致力于创建一个功能齐全的组件库，以使我们在 React 中的工作更加简单，视觉上更加一致。我们现在在整个应用程序中使用[火柴盒](https://sparkpost.github.io/matchbox/?selectedKind=Welcome&selectedStory=to%20Storybook&full=0&down=1&left=1&panelRight=0&downPanel=storybook%2Factions%2Factions-panel)，除了自定义角盒之外，很少考虑 CSS。

**开放性:**客户端代码在你的浏览器中运行时已经是公开的。因此，我认为没有理由将代码保存在存储库中。我们不期望除了我们之外的任何人会使用这个代码(请不要)。能够指出我们正在做的事情的例子并直接链接到 GitHub 中的代码已经很好了。

**测试和监控:**这是我们重建工作的一个大目标。我们在 Angular 中的 Selenium 驱动的功能测试花费了几个小时来运行，并且不断失败，直到我们最终完全关闭它们。在新的应用程序中，我们正在编写大量的测试(ðÿ'‹快照)，但我们很早就决定，我们永远无法用测试用例来预测每个 bug。因此，我们还投资于实时错误记录和监控。不再需要等待客户报告 8 小时前发布的部署中引入的错误。快速稳定的测试辅以错误监控是我们前进的新方向。

**“保留和改进”作为重新设计策略:**换句话说，我们保留了应用程序的架构。把大部分东西放在你期望能找到它们的地方。避免难以置信的剧烈变化，这将需要大量的批准，用户测试等。在我们重新构建应用程序的每个部分时，我们也抓住了每一个机会来做出简单、明显的改进。到目前为止，结果感觉就像是在熟悉的基底上涂了一层难以置信的新漆。这有望在我们向现有客户推出新应用时对我们有所帮助。

具体来说，增量推广是我们庞大计划的最后一个重要部分，也可能是目前定义最不明确的部分。我们知道我们想逐步向用户推出应用程序(随机和/或允许用户选择加入)，这样我们就可以在向每个人发布之前测试它在真实用例中的工作情况。我们仍在寻找这方面的选择，但正确的推出将是我们整个计划中最重要的部分之一。

### [](#the-point)点到为止

这里的要点是，你应该对我说的任何事情持怀疑态度，尤其是如果它听起来很好或很理想化。当涉及到应用程序开发这样的事情时，实用几乎总是比纯粹要好。

快乐的画猫头鹰！

帖子[如何用 React 画猫头鹰:一个迁徙的故事](https://www.sparkpost.com/blog/react-migration-story/)最先出现在 [SparkPost](https://www.sparkpost.com) 上。