# 关于 Elm 编译器性能和文件组织的一个注记

> 原文:[https://dev.to/bloom/a-note-on-elm-compiler-perf-文件-组织-467](https://dev.to/bloom/a-note-on-elm-compiler-perf--file-organization-467)

我今天做了一些实验，当我在一个项目上工作时，我意识到我添加的新模块需要大约五秒钟来编译，而以前这个应用程序只需要大约两秒钟就可以编译。

我做了一些研究和实验，并且记得为了让 Elm 编译器快速工作，你应该在那些由最少的其他文件导入的文件中最频繁地进行修改。**一个文件导入多少其他文件**并不重要，重要的是*一个文件导入多少文件*。

在我的例子中，我制作了一个新的小部件，并将它的所有部分放在一个文件中。(其中它的片段是它的类型、更新函数、查看函数等...).我意识到这一个文件(姑且称之为`Foo.elm`)是由应用程序的`Types.elm`文件导入的。该文件碰巧包含在应用程序中的一堆其他文件中。所以当我更改`Foo.elm`时，导致`Types.elm`被重新编译，从而触发了项目中一堆其他文件的重新编译。

作为实验，我只提取了从`Foo.elm`到`Foo/Types.elm`的类型。在编辑`Foo.elm`时，它将重新编译的时间减少了将近整整两秒。我想象我可以通过拆分视图、更新等等来节省更多的时间...放到他们自己的文件里。

从组织的角度来看，我不太喜欢这样，但它确实大大加快了编译器的速度。

* * *

编辑:

FWIW，我把所有东西都放在 Foo.elm 中，以便遵循这里给出的方向:youtube.com/watch?v=XpDsk374LDE.，我认为这是一个好的方向，但只是把应用程序的一部分放在同一个文件中并不是编译器性能的最佳选择。

我还没有尝试过这种方法，但是我认为，比将类型提取到 whatever/Types.elm 文件中更好的方法是，根据需要将视图函数提取到它们自己的文件中，因为视图通常是迭代的对象，如果对您来说速度太慢，也可以提取更新函数。

请考虑以下几点:

*   将一个函数拆分成它自己的文件只有在它没有被大量文件导入的父函数时才有帮助。如果您将一个函数提取到它自己的文件中，如果您希望看到编译速度的提高，您可能也需要将它的父函数提取到它们自己的文件中。
*   为了提高性能，应该尽可能将在许多地方使用的函数移到它们自己的文件中，并且不应该导入任何您将定期更新的文件。
*   这是一个权衡游戏，处理成吨的文件可能是一种痛苦。疯狂地将所有函数放入它们自己的文件中可能是个坏主意。

照片由 Veri Ivanova 在 Unsplash 上拍摄