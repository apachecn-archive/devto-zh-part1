# 持续交付的优势

> 原文:[https://dev . to/Henrik warne/benefits-of-continuous-delivery-5h2m](https://dev.to/henrikwarne/benefits-of-continuous-delivery-5h2m)

在我作为软件开发人员的职业生涯中，我看到发布频率在稳步增长。当我开始的时候，新功能需要 12 到 18 个月才能到达客户手中。几年后，频率增加了，所以每三周就进行一次生产部署。在过去的两年中，我们一直在工作中使用连续交付。这意味着一旦一个特性准备好了(实现、代码审查和测试)，它就被部署到生产中。持续交付在我看来是目前最好的方式，原因如下: [![](../Images/b3dbd54c58914cfa85b856ea07d154a9.png)](https://henrikwarne1.files.wordpress.com/2017/11/dscf7127-e1511090544736.jpg)

### [](#benefits)好处

**降低风险。**我喜欢在每项新功能完成后立即部署的首要原因是它降低了风险。每次你改变软件都有引入错误的风险。如果部署的更改很小，那么在出现问题时需要查看的代码就很少。如果你每三周才部署一次新软件，那么会有更多的代码会导致问题。如果不能快速发现或修复问题，恢复小规模部署也比大规模部署容易得多。

**记忆犹新。**如果我在一项新功能准备就绪时就部署它，那么它的一切都会历历在目。因此，如果出现问题，解决问题要比我在此期间开发其他功能更容易。这也释放了精神能量来完全完成一个特性(包括部署到生产)。我可以一次专注于一件事，而不是一心多用。

**功能更快地到达客户手中。**在所有条件相同的情况下，功能越快到达客户手中越好。为生产准备好一个特性，但不部署它，是一种浪费。

**更快的反馈。**客户越早开始使用新功能，您就能越早了解哪些功能有效，哪些功能无效，以及他们希望进行哪些改进。通常，直到客户试用了当前的功能并提供了反馈，才知道下一个要开发的功能。此外，尽管测试很有价值，但它永远不如在生产中运行新代码好。生产环境中的配置和数据将揭示您在测试中永远不会发现的问题。因此，越早部署它，您就能越早发现并解决代码中剩余的问题。

### [](#prerequisites)先决条件

要使持续部署发挥作用，必须满足许多前提条件。没有这些，很难或不可能持续部署新代码。

**中央服务器。**该系统必须基于云或从中央服务器运行。如果系统是在客户的前提下运行并在他们的控制之下，那么一天多次部署新版本显然是行不通的。

**DevOps 文化。当开发人员创建新特性并部署它们时，持续交付效果最好。没有交接工作——如有必要，由同一个人编写代码、测试、部署和调试。这句话(来自亚马逊首席技术官沃纳·威格尔)完美地总结了这一点:“你建立它，你运行它。”**

**自动化。**当您一天多次部署到生产环境中时，部署必须快速简便。这意味着几乎所有构建和部署新版本的机制都必须自动化，以避免手动步骤。系统的其余部分也必须支持快速构建和部署。在工作中我们使用 docker 和 kubernetes，效果非常好。

**滚动升级。**如果在软件部署期间系统不可用，您将在部署前三思。为了避免这种情况，应该对系统进行设置，以便您可以逐个服务器地部署新功能，而不会中断服务。

**可恢复的。**在新部署出现问题的情况下，应该很容易回到软件的先前版本。如果部署新版本很容易，那么这通常不是问题——您只需使用相同的系统再次部署旧版本。

**知道什么是跑步。**当运行的软件版本一天变化几次时，能够分辨出是什么是很重要的。这意味着既要知道当前运行的是什么，又要知道何时进行了更改。在工作中，我们结合软件的 git 散列使用版本号。此外，每个软件部署都在单独的版本文件中提交。

### [](#but)但是……

**虫子。**有些人，尤其是习惯了预定发布的人，会对连续交付感到不安。这些频繁的发布难道不会导致更多的 bug 吗？根据我的经验，不，现在不会有更多的 bug 了。在预定的版本中偶尔会有 bug，在持续部署时偶尔也会有 bug。现在不同的是，当有 bug 的时候，更容易更快的找到并补救。

**浸泡。但是在发布新特性之前，让它们在测试环境中“浸泡”一段时间怎么样？这难道不会发现隐藏的错误吗？这是一个在理论上比在实践中更有效的论点。在你认为一个特性已经完成之前，你要执行所有你能想到的测试来说服你自己它能像预期的那样工作。有可能在测试环境中会发现一些 bug，即使你并没有在寻找它们，但是在实践中这几乎不会发生。更有可能的是，只有在产品中使用该特性时，才会发现任何剩余的错误，以及真实的配置、数据和流量模式。因此，频繁部署的其他优势超过了通过延迟部署来发现潜在错误的可能性。**

### [](#conclusion)结论

作为一名开发人员，我想尽我所能来确保尽可能快地创建无 bug 的特性。连续交付是在这方面有所帮助的一种工作方式。一次部署一个特性可以显著降低每次部署的风险。如果有问题，代码在我的脑海中是新鲜的，与以前的部署相比变化很小，所以故障排除容易得多。此外，它可以更快地将功能提供给客户，从而实现更快的反馈。比较预定的发布和连续的交付，我更喜欢连续的交付。