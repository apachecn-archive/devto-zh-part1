# 作为开发人员进行测试

> 原文：<https://dev.to/arne_mertz/testing-as-a-developer>

*本文[原载](https://arne-mertz.de/2015/10/testing-as-a-developer/)在我的个人博客[“简化 C++！”](https://arne-mertz.de)。简化 C++！是一个关于现代 C++和干净代码的博客。*

我现在的雇主有一个[公司博客](http://blog.zuehlke.com/)——里面有一些非常好的内容。其中一个帖子的标题是[‘因为我不是测试人员，所以我不写任何测试，这有什么错？’](http://blog.zuehlke.com/en/whats-wrong-with-i-dont-write-any-tests-since-i-am-not-a-tester/)——这让我想到了开发人员与测试的关系，以及任何认真说出这句话的开发人员的自我形象。

# 测试还是不测试

那么，测试是关于什么的呢？它是关于检查某个东西是否工作。无论你写了一段新的代码，或者你修改甚至删除了它，你都必须检查它是否做了它应该做的事情。

您是否曾经更改过一个源文件，然后签入它，关闭票证，甚至回家，而没有进一步验证您刚才所做的是正确的事情？我有。我想每个人都有。接下来最有可能发生的是以下选项之一:

*   CI 或构建服务器向您发送一封邮件，告知您有一个构建失败或某个自动测试失败。
*   一个愤怒的同事敲你的门，因为他下载了最新的代码，得到了一个构建错误，并花了一些时间研究错误源自哪里，是谁签入了这段代码。
*   某个恼火的测试人员把你刚关的票退回来，因为问题根本没修好。

还有很多其他可能的结果。然而，对于任何不仅仅是修复一个愚蠢的小类型的事情来说，最不可能的一个结果是，所有的事情真的会立刻如你所愿。

# 测试什么

所以我们*必须测试我们实现的代码变更。问题是:我们应该测试多少，我们的测试应该多彻底？*

在更改代码后，我们应该测试三到四件事情:

1.  程序还可以执行吗？这当然包括受代码变更影响的翻译单元的编译，但并不仅限于此。您可能需要包括链接器在内的完整构建、目标平台的部署，甚至是冒烟测试。
2.  变革有预期的效果吗？bug 真的消失了吗，或者您实现的特性的行为符合规定吗？转角箱包括在内吗？
3.  这种改变没有不良副作用吗？确保你刚刚做的只是你想让它做的事情。不应该有倒退，不应该改变或破坏其他特性，不应该影响性能和其他可用性指标。
4.  **代码质量还可以吗？**与其他要点相比，这一点不太明确，但仍然很重要。有些人可能认为这是次要问题，因为内部代码质量对用户来说是不可见的，所以它没有直接的客户价值。然而，除非您在不久的将来扔掉代码，否则糟糕的代码质量会严重损害您维护代码的能力，这反过来会对客户价值产生影响。

# 但这不是我的工作/角色，我们有质量保证！

哦，但它是。我们的工作是写*工作*代码。因此，除非我们确实知道我们的代码是有效的，否则我们还没有完成。我们的工作描述不是“在源代码文件中键入随机字符”，也永远不会是。这类工作的报酬通常很低，通常一天一两根香蕉，不会更多。

这并不意味着不需要 QA。测试人员是开发人员的安全网。他们确保代码不仅仅按照开发人员认为应该的方式工作，他们检查软件的工作方式是否与它应该的工作方式一致。

他们的工作不是打另一边的无休止的任务乒乓球。每当一个测试人员将一个任务送回开发部门时，就会出现问题。理想情况下，在这种情况下，不仅应该解决问题，而且应该调查问题的原因，这样它就不会再次发生。

# 如何测试

我将回到我们应该测试的四种不同的东西，因为我们可能想要以不同的方式测试它们。

**构建和部署**永远是我们要做的第一件事，所以这自然是我们最常做的事。作为程序员和——根据陈词滥调——技术爱好者，我们应该利用我们的才能和手头的工具来做我们最擅长的事情:自动化构建。

如果我们必须像构建和部署一样频繁地做的事情不仅仅是单击或命令，那么仍然有改进的空间。因为它运行得如此频繁，所以请确保它不会花费太长时间。如果冒烟测试或部署到每个平台需要超过一分钟的时间，就不要进行快速构建，而是准备另一个可以执行完整部署测试的命令。

根据它们的范围，针对不想要的变更的测试也必须相对频繁地进行，所以你也应该将它们中的大部分自动化。有几个粒度级别和相应的运行时间。

单元测试检查单个类、函数以及有时更小的子模块的行为。这些检查发生在与类设计相同的层次上，所以除了开发人员之外，没有人知道设计，也没有人能够编写这些测试。

验收和集成测试检查应用程序的大部分，但通常不是全部。因此，通常需要开发人员来使它们工作，例如通过模仿程序中缺失的部分。

关于所有不同类型的回归测试，还有很多要说的和要写的，但是在这一点上我不会深入细节。重要的是:如果你经常修改你的代码，你会希望经常运行大多数测试。所以你最好把它们自动化，让它们更快。

检查代码变更是否成功通常需要在相同的不同级别上进行检查，并且通常你需要不止一次地运行它们，尤其是当你实现的需求很重要的时候。

你猜怎么着？你最好把它们自动化。这样做的额外好处是，一旦您的特性完成，您可以将它们添加到回归测试套件中。按照 QA 编制、测试和批准的方式完成。

**代码质量**也可以被自动检查，尽管像静态分析器等工具不应该是告诉你代码质量好坏的决定性的最后实例。代码质量可能是主观的——并不是所有的事情都可以通过工具来完成，所以你最好让某人检查你的代码，或者通过结对编程，或者作为你的过程的一部分进行代码检查。

## 问:我真的应该自动化所有的事情吗？

嗯，差不多了。你不能自动化所有的事情，因为例如探索性测试是一个高度直观的过程，不能由机器来完成。其他测试的自动化可能非常耗时，例如，因为测试对象与可用的测试工具不匹配。

然而，自动化测试不仅是可重复的，因此比手工测试更可靠。如果操作正确，它们可以半自动甚至自动触发，例如通过代码检入。这样，只需要一台计算机来运行它们，就可以节省宝贵的人力。最终结果是,“测试”运行得更频繁了，这反过来导致更早地发现错误和更可靠的软件。

> **底线**:自动化任何技术上可以自动化的测试，只要建立自动化的成本低于手工测试的累积成本。努力以一种促进测试自动化的方式来设计你的代码和架构。

# 当一切都自动化时，为什么还要有人类测试人员呢？

首先，如上所述，测试人员对功能需求的看法与开发人员不同，因此验收测试尤其受益于测试人员和开发人员的合作。

其次，总会有以前没有考虑到的东西，所以会有自动化测试没有覆盖的角落。必须有人在软件中摸索，试图找到那些盲点，这也被称为探索性测试。

# 开发者的结论

每个开发人员都应该有一些职业自豪感。这种自豪感要求我们努力追求完美，这反过来意味着我们想要交付完美无瑕的软件。我们永远不会到达那里，(因此需要 QA 作为最后一步)，但是作为专业人员，我们的目标应该是尽可能地接近那里。

如果我们尽可能彻底地测试我们的代码，我们肯定会更接近，所以测试，尤其是编写自动化测试，并不是应该避免的低级任务。这是我们工作的核心部分。