# 在不同的测试阶段测试第一次开发

> 原文:[https://dev . to/grahamcox 82/test-first-development-in-different-test-stage](https://dev.to/grahamcox82/test-first-development-at-different-test-stages)

这篇文章会有些争议，所以我提前为此道歉。

我不喜欢测试优先开发。我喜欢测试驱动开发，但对我来说，它只在某些方面工作得很好。

首先是我所说的一些定义:

*   测试驱动开发。在这种情况下，你要为你的所有代码编写测试，既要确保你所做的工作有效，又要确保它不会在将来崩溃
*   先测试开发。在这种情况下，您需要在编写代码之前编写代码测试。这种方法的支持者喜欢它，因为它有助于在你编写代码之前确定代码的使用方式，这对于软件设计来说是无价的。

现在，澄清一下，只有某些形式的测试，我个人不喜欢测试优先开发。具体来说，就是单元测试。

当你正在开发一个其他代码——无论是你自己的还是其他人的——都将依赖的整个系统时，测试优先开发会非常有效。这可能是一个 REST API，或者一个内部模块，或者任何东西。这里的关键是它是一整套代码，而且它必须有一个好的外部 API，因为其他代码将依赖于它。

对我个人来说，在进行单元测试时，测试优先开发并不好用，因为在进行单元测试时，你仍然不确定你的代码的内部架构到底是什么。再加上我对静态类型语言的偏好，这就变得更加麻烦了。

在测试优先开发的世界中，您应该:

1.  编写一个失败的测试来描述您正在实现的下一个微特性，或者重构一个现有的测试来覆盖它
2.  编写足够通过测试的代码
3.  重构您的代码
4.  重复

这个想法是，软件设计最终是迭代的，你不需要花很长时间去做昂贵的软件设计。

然而在现实中，我个人的经验是。

1.  编写一个失败的测试来描述您正在实现的下一个微特性，或者重构一个现有的测试来覆盖它
2.  决定到目前为止你写的代码是否真的适合下一个微特性，或者是否需要重构
3.  重构现有代码以更好地适应。您需要删除新的非编译测试，以便其他测试可以运行来判断是否有问题
4.  重写新的测试
5.  为新特性编写代码
6.  重构您的代码
7.  重复

所有这些中间的额外步骤成本非常高，因此实际上您最终所做的更接近于:

1.  首先在纸上对整个(子)系统进行全面设计。不管是 UML 还是只是餐巾纸上的一些笔记。
2.  编写单元测试。这些将无法编译，所以整个构建现在都被破坏了，并且您不知道还有哪些测试仍然通过或失败
3.  编写您在步骤 1 中设计的所有代码

现在，这不是测试优先开发的工作方式。这几乎与它的本意背道而驰。但是以我的经验来看——不可否认这是被我使用的语言所影响的——这就是结局。

然而另一方面，对于任何有外部 API 的东西——无论是 REST、GraphQL、Java 还是其他——测试优先开发是非常棒的。在这种情况下，编写测试将有助于确定 API 的工作方式，并有助于突出 API 工作不如预期的地方。这样，在您编写一行生产代码之前，您就可以得到一个更好的 API。然后你就可以在这个 API 中构建你自己的单元，并确信面向外部的部分会很好。这就是测试优先开发的全部内容。