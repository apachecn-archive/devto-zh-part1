# 我在 React 本地应用中使用模拟 API 的原因

> 原文:[https://dev . to/goshakkk/reasons-I-use-a-mock-API-in-react-native-apps-3 aoj](https://dev.to/goshakkk/reasons-i-use-a-mock-api-in-react-native-apps-3aoj)

这些天我做了很多 React 原生应用。

从开发者体验的角度来看，它们的共同点是:它们避免调用真正的 API，而是使用假数据。如果/当需要的时候。

这对我来说是一个非常有用的策略。这篇文章不会深入探讨如何实现这一点(因为有几种方法)，而是将重点放在*为什么*上。

## 为什么

### 1。后端可能还没有实现。

后端与移动应用程序一起开发，并且需要更长的时间来实现，这并不罕见。

这绝对不应该阻止你对应用程序的工作。

只要以某种方式指定了后端的端点，您就可以模拟它们。规范可以是任何东西:可以是 RAML 模式，可以是描述端点及其响应类型的文本文档，也可以是其他东西。

### 2。您可以在飞行中开发。

或者在其他情况下，你可能没有互联网连接，或在一个低劣的连接。

“但是你可以在本地保存一份后端的副本，然后使用它！”

首先，你不能总是这样。有时候后端对你来说是一个黑匣子，你没有来源。

第二，后端可能需要外来的依赖和非常仔细的配置。在大多数情况下，开发移动应用程序不需要做这些事情。

### 3。如果服务器停机或损坏，您的工作效率不会受到影响。

它发生了，我们应该处理它。

不必依赖真正的 API 意味着您的生产力不会受到影响。

### 4。你可以控制延迟。

您可以轻松地将模拟的“延迟”降低到 0，以便快速开发。

您可以很容易地将“延迟”设置为几秒钟，也许是为了看看您的应用程序在这些条件下会如何表现。

不与真正的远程 API 对话意味着您可以控制延迟。

### 5。你可以模拟错误。

请求可能会以各种错误结束。

有些是您可以控制的(如发送无效数据)，而有些则不是:

*   内部服务器错误；
*   会话已过期。

如果你在和一个真正的 API 服务器对话，你通常不能随意触发这些。

拥有一个模拟 API 意味着你也可以控制这些。

这意味着您可以轻松地测试您的应用程序在类似“如果我得到一个会话过期错误，注销用户，显示登录屏幕，并提醒他们为什么会发生这种情况”的情况下是否正常运行

## 嘲讽是有代价的，但它仍然有用

因为它要求您维护一组假数据，并在 API 改变时更新模拟，所以您不会免费得到模拟。

也就是说，生产率的好处可能会超过维护虚假数据的成本。

## 如何

有多种方法可以模仿 API。最简单的方法是调整您的 API 客户端:

```
// helper function
// used as: delayedPromise(1000, "hey")
// will return a promise that will resolve with "hey" in 1000ms.
function delayedPromise(ms, value) {
  return new Promise(resolve => {
    setTimeout(() => resolve(value), ms);
  });
}

const USE_REAL_API = true; // change to `false` when needed

function getPosts() {
  if (USE_REAL_API) {
    return fetch(...);
  } else {
    // new: fake data
    return delayedPromise(500, [
      { id: 1, title: 'How to' },
    ]);
  }
} 
```

当然，在实现 API 的模拟时，还有更多的方法&更多的要考虑。这篇文章不会深入讨论这个问题，但是我可能会在某个时候写一些。

* * *

我在博客上记录了所有事物的反应和反应。
如果你喜欢你在这里看到的，[订阅这里](http://goshakkk.name/subscribe/)以确保你不会错过我的下一篇文章。