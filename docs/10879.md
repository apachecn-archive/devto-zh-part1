# 大规模重构的心理战

> 原文:[https://dev . to/developerscode/the-psychological-battle-of-big-refactorings](https://dev.to/developerscode/the-psychological-battle-of-big-refactorings)

我们通常用与所有其他类型的软件编写相同的迂腐方法来谈论重构代码。我们想出方法来进行抽象、分解和澄清。我们将这些技术融合成更大的想法和更吸引人的名字，如天皇方法，大爆炸方法，分而治之，或扼杀。好吧，可能不是所有的都朗朗上口。

但是，有了这些战略工具，大的重构仍然需要巨大的精神耐力和毅力。事实上，真正让它变得困难的是我们自己的心理，而不是代码本身的形状。

在大多数大的重构中，我们没有完全重写的奢侈。需要构建功能；虫子需要被压扁。我们唯一的选择是逐步将飞行生产代码推向一个新的方向。我们不断地进行小的改变，抓住时机在合适的时候重塑系统的一部分。

这就是问题所在。修复仍然需要为其客户服务的代码通常需要一些额外的权重，以允许新代码进入，同时仍然保留我们尚未清理的旧代码。

重构可能需要创建短暂的对象和方法，这样我们就可以用新的暂时适应旧的。当这些额外的路径被创建时，代码会感觉到它在接缝处膨胀——因为它*就是*。一个大的重构很少像把一个丑陋的部分换成一个漂亮的部分那样卫生。这通常意味着加入大量的中间结构；丑陋但必要的脚手架让我们的病人能够在动手术的同时做日常杂务。

在任何大的重构中，你都必须应对两种不和谐的想法:试图让代码库变得更好，以及现实——在此过程中，代码可能实际上感觉糟糕了很多。这也许是整个过程令人望而生畏的真正原因。重构中的每个决定都要权衡短期痛苦和未来回报。而且，通常，短期的痛苦让我们相信今天不是开始的日子。

然而，一旦你接受了这一点，一个大的重构就变得更容易忍受了。你并不是在和一个魔鬼战斗，这个魔鬼会因为你现在为了明天的财富而做出的偏离轨道的举动而责骂你。最终，我们到达了光荣的一天，旧的脓肿可以被完全清除，我们的新代码处于完全控制之下。但是，在那之前，这场战斗就像在我们的代码中一样在我们的脑海中。

*经[许可转载《生命模仿密码](http://lifeimitatescode.com/the-psychological-battle-of-big-refactorings)。*