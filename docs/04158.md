# 驱动开发

> 原文:[https://dev.to/taq/driver-driven-development-l0](https://dev.to/taq/driver-driven-development-l0)

*最初发布于葡萄牙文[eustaquiorangel . com/posts/Ambiente _ minimo _ driver _ driven _ development](http://eustaquiorangel.com/posts/ambiente_minimo_driver_driven_development)T3】*

几周前，我在一个 Ruby on Rails 项目中发现了一个奇怪的情况，并对项目负责人做了一个有趣的类比。我想要与你分享它。

## 汽车停在车库里...

想象一下，我们正在和汽车修理工一起工作。所有的汽车都有相似的特征，比如有四个轮子、引擎、门等等。其中一些具有非常奇特的特征。以此类推，*汽车*就是*软件项目*，由于我们是优秀的机械师(*开发人员*，我们知道如何处理通用特性和一些最具体的特性。

然后来了一个人，说有一辆车停在车库有一段时间了，让我更换它的*交流发电机*，已经有缺陷了。交流发电机是特定的*项目特色*。他需要尽快改变这部分，好的，让我们看看我能做些什么。

我要求进入*车库*，这是*代码库*。那个人给我打开车库，我把盖着防水布的车推出车库(*克隆库*)。直到那一刻，我都不知道这是一辆什么样的车，直到我在防水布下看了一眼(阅读*项目文件*)。我拿掉防水布，好吧，东西显然都在，毕竟是辆车。

直到那时，我才注意到少了一些东西。有一些保险丝(谈论 Ruby on Rails 项目，即`database.yml`)没有到位，没有它们，就没有机会打开引擎。幸运的是，我有一些备件，我只需要问客户是否记得它是多少安培(*生产*配置，这是环境变量，好的)。我注意到有一些非常*旧的棋子*我不再需要了(宝石 *therubyracer* )，然后我把它拆下来，直接连接电线，让它工作(*节点*被安装，所以，它工作)。

然后我记得那个人提到汽车中有一个丢失的零件(一个不再存在的外部私有存储库)，她家里有这个零件(存储库代码的副本)。我去那里，用一个 u 盘把它取出来，放在适当的位置。

然后我试着开了车，但是我拿到的*钥匙* ( *登录数据*)坏了(登录系统没用，登录数据错误)。我试图寻找备用钥匙，并找到三把*备用钥匙的规格，每把钥匙都可以打开汽车，但会改变面板布局，虽然很旧，但这是数字布局，对于我从未见过的布局，*特定于特定汽车*(带有大量菜单和功能的自定义布局)。由于这些键都不存在，我只有它们的*规范*(每个用户的*特征*，我在代码中找到了这些特征)，我打开车床使用规范构建键(输入`seeds.rb`文件)。现在，有了钥匙，我可以打开车了。*

这辆车有燃料，但缺少机油、制动液和许多让它正常工作所需的东西。我花了一些时间查看汽车手册中的规格说明(阅读登录所需的模型文件和数据)，过了一段时间，我就可以满足所有这些需求了。我已经让那个人把缺失的部分发给我(数据库*转储*，但是她没有交通工具(她所在的地方没有互联网)，所以我必须自己做这件事。随便啦。

我打开车门，打开它，第一个钥匙面板亮了，有很多我一生中从未见过的自定义选项(但我终于登录了，耶)。好的，有些是基本的，但大多数，我不知道，我需要看看它们是如何工作的，它们是用来做什么的。

现在我终于可以集中精力完成交给我的最重要的任务了:用新的替换交流发电机。我有两个选择:

1.  把现在的交流发电机换成新的，是不同型号的，让车主带着去兜风。这种方式可能会导致一些麻烦，汽车熄火，着火，爆炸，或其他一些灾难，因为我没有诊断更换旧零件后的汽车，我只知道它开始工作。

2.  将我的笔记本电脑连接到车载电脑上(即*测试套件*，嘿，有一个测试套件，这是个好消息！)并检查新零件是否一切正常。但是我发现在所有可供测试的特性中，几乎有 50%都失败了！即使我只关注交流发电机相关的测试，也会产生很多噪音。我问这个人，计算机是否有一些缺陷，我是否可以隔离所有这些测试失败，以避免在诊断新零件时产生噪音，并说明这对于稍后检查这些测试失败的原因非常重要。

我等待一个回答，以及对正在做的其他事情的评论，但这需要一段时间，一天的结束即将到来。最好把车放回车库，等回音。然后我发现那个人关上了车库锁，把钥匙拿走了(我对代码库没有*写权限*)。然后我把车放在我在那里附近的一个车库里(我在仓库里做了一个*叉*)，只是为了确保它是安全的。为了避免忘记这个传奇的所有细节，我在一个小笔记本上做了一些笔记(*自述*文件)。

## 驱动开发

正如我在以前的一篇文章中已经评论过的，我似乎举了一个“代码味道”的例子，也就是说，工作代码，但是只在已经配置成适合其需求的环境中工作，也就是说，在开发它的人的计算机上工作，并在那里保持几个月，运行而不删除它的代码，如此根深蒂固，以至于它几乎形成了一种特殊的味道，就像你经常忘记清洁的汉堡烤架。已经配置了一个`database.yml`文件，数据库中充满了登录所需的所有数据，有许多代码调整、更改(比如注释外部存储库)和环境变量，这些都使得项目只能在那台计算机上*运行*。

但是作为一个参与项目的新人，为了简单地运行服务器和登录，我需要做所有这些任务，这花费了我几个小时的时间，以及任何其他最终需要与项目一起工作的新人，并且没有一个非常了解它的人的支持。有一次，我听到一位大学教授说，好的文档或书籍不需要附上作者，我同意。我们需要好的文档，更有表现力和组织性的代码。

Ruby on Rails 框架为我们提供了做这些事情的所有条件，允许任何有权访问代码的人以一种非常简单和快速的方式在本地运行项目，如果您遵循某些约定(嘿，毕竟“约定优于配置”)和实践，例如，正确地馈送您的`seeds.rb`文件，创建一个包含特定信息和指令的自述文件来运行项目，并使您的测试套件保持在工作状态，允许它运行， 允许它快速运行，更好的是，允许需要参与项目的人阅读您的测试并理解项目的行为。

就像我们在这里做的那样，像汽车一样思考这个项目。你唯一需要的就是把车库钥匙给你想开的人，在车盖上方找到车钥匙，打开车门，发动引擎，开车。简单。如果开车要花更多的时间，也许花点时间整理东西是个好主意。把重点放在会开车的司机身上，也就是会工作和运行你的项目的开发人员。让司机的事情更简单，即使司机是你。