# React 中的虚拟 DOM

> 原文：<https://dev.to/sarah_chima/the-virtual-dom-in-react-h5>

反应快！！！一个主要原因是因为它利用了虚拟 DOM。虚拟 DOM 不是由 React 创建的，但是 React 对它的使用使它流行起来。在我们考虑什么是虚拟 DOM 之前，我认为有必要对 DOM 做一个简单的解释。

**文档对象模型(DOM)**

DOM 是 HTML 和 XML 文档的编程接口。它将这些文档表示为节点和对象。它使得程序能够访问和操作这些文档的结构、风格和内容。所以有了 DOM，HTML/XML 文档中的任何内容都可以被访问、修改、删除或添加。

**DOM 操作的问题**

DOM 的问题是浏览器对它的操作很慢。它不是为创建动态用户界面而优化的，所以它的性能不是很好。虽然 JavaScript 和许多框架使得以优雅的方式访问和操作 DOM 成为可能，但它们对提高 DOM 的性能几乎没有帮助。

我用一个例子来说明这个问题。您有一个待办事项列表，其中包含不同的待办事项，您决定将其中一项勾选为已完成。这种变化必须反映在屏幕上。大多数框架如何处理这种变化？

该列表将被重建。哇！！因此，一个条目的变化会影响列表中的所有其他条目，即使它们没有被选中。现在想象一下，如果列表上有大约 100 个项目，它们都必须被重建。主要问题不在于 DOM 对列表的重建，这可能会很快发生。它出现在其他过程中，比如重新计算列表的 CSS 和更新页面的布局。这些其他进程使用复杂的算法，这些算法不是很快，因此会影响性能。

在这里，我们谈论的是一个简单的应用程序，待办事项列表。大多数网页要比这复杂得多，在一个页面上有很多交互。我们可以想象在像脸书页面这样的网页上进行的 DOM 操作的数量。所以这个过程是低效的，超时会降低页面的性能。

这就是虚拟 DOM 的用处。什么是虚拟 DOM？

**虚拟 DOM**

虚拟 DOM 是 DOM 的轻量级副本。它包含 DOM 对象的所有对象和节点，但是它没有能力直接改变屏幕上显示的内容。

那么 React 是如何使用虚拟 DOM 的呢？

让我们用上面 Todo 列表的例子来解释这一点。当一个事件发生时，比如一个列表项被检查为完成，React 创建一个 DOM - **虚拟 DOM** 的副本。这个过程发生得非常快，所以不会影响性能。React 保存了这个虚拟 DOM 的快照...就像一个不变的虚拟 DOM。虚拟 DOM 随着已经发生的变化而更新，即所有对象(列表项)都得到更新。记住，在这个过程中，真正的 DOM 并没有被更新。

接下来，React 通过一个名为 **diffing** 的方法来比较两个虚拟 DOM(更新前虚拟 DOM 的快照和更新后的虚拟 DOM ),以检查发生变化的确切对象。这个差分还计算了更新实际 DOM 所需的最少步骤数。然后它更新这些对象，并且只更新真实 DOM 上的这些对象。在我们的例子中，它只更新真实 DOM 中的列表项，这种变化可以在屏幕上看到。

为了确保你得到了流程，这里有一个有序的列表。

1.  列表项被检查为已完成。
2.  React 通过构建真实 DOM 的副本来创建虚拟 DOM。
3.  保存这个虚拟 DOM(即另一个虚拟 DOM)的快照，然后更新它。
4.  使用 diffing 比较两个虚拟 DOM，以获得已更改的确切对象。
5.  用这个变化更新真实的 DOM，并且只更新这个变化。

React 只更新 DOM 中必要的部分。很明显，这个过程更高效、更快速。在 React 中使用虚拟 DOM 极大地提高了 React 中内置的应用程序的性能。这就是 React 快的原因。

对虚拟 DOM 有什么要说的，欢迎发表评论。

感谢阅读:)