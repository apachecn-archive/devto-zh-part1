# 了解持续集成

> 原文:[https://dev.to/abulkay/understanding-continuous-integration](https://dev.to/abulkay/understanding-continuous-integration)

持续集成(CI)是软件开发周期中的一个阶段，来自不同团队成员或不同特性的代码被集成在一起。这通常包括合并代码(集成)、构建应用程序和执行基本测试，所有这些都在一个短暂的环境中进行。

过去，代码是在软件开发生命周期的“集成阶段”集成的。这个阶段是在不同的团队花费数周、数月甚至数年的时间分别致力于不同的(部分)应用程序或服务之后。您可以想象项目的集成阶段会有多痛苦。在这个阶段花上几周甚至几个月的时间并不少见。这是在瀑布时代。

随着极限编程(XP)和敏捷的发展，集成变得越来越频繁，开发人员通常在一个单元完成后很快就进行集成。这是在共享源代码存储库上完成的。频繁的集成变得自动化和持续，这促使在集成新代码之前需要某种检查。因此，持续集成。

CI 工作流程因工具、编程语言、项目和许多其他因素而有很大不同，但一个共同的流程包括以下步骤。
推送至代码库
静态分析
预部署测试
打包并部署至测试环境
部署后测试

让我们看看这个流程如何在一个使用 gradle 作为构建工具的 java 项目中工作

## [](#code-repository)代码库

通常会有一个代码库和一些用于贡献新代码的工作流。根据工作流，提交代码启动 CI 管道，CI 管道通常从静态代码分析开始。你可以参考这篇文章来选择一个合适的工作流程。

## [](#static-analysis)静态分析

静态(代码)分析是在应用程序的代码基础上完成的，不需要运行软件。这里的目标是确保代码没有可能的错误，并且符合标准的格式和样式。

让我们添加 FindBugs 来检查可能的错误，并添加 Checkstyle 来确保项目符合编码标准(我们将使用 Google Java 风格)。Gradle 构建脚本应该是这样的:

```
apply plugin: 'java'
apply plugin: 'findbugs'
apply plugin: 'checkstyle'

repositories {
    mavenCentral()
}

dependencies {
  ...
}

tasks.withType(FindBugs) {
  reports {
    xml.enabled false
    html.enabled true
  }
}

tasks.withType(Checkstyle) {
  reports {
    xml.enabled false
    html.enabled true
  }
} 
```

为了完成 Checkstyle 配置，我们需要将 Checkstyle 配置文件添加到项目路径 config/check style/check style . XML 中。配置了 FindBugs 和 Checkstyle 后，现在可以运行静态分析了:

`$ gradle check`

## [](#predeployment-testing)部署前测试

在这个阶段，任何不部署到服务器上就可以运行的测试都应该被部署到服务器上。这将包括单元测试和各种其他类型的测试(可能是功能性的或集成的)。这个阶段用于确保变更集不会破坏功能，并且与代码的其他部分配合良好，因为测试是在整个代码基础上运行的，而不仅仅是新的变更(正如作者可能在 dev env 上所做的)。

一旦 ci 管道的这个阶段成功通过，新的变更就可以被接受，并准备好进行进一步的测试(如果需要的话，可以进行自动化和用户测试)。然而，在这个阶段和下一个阶段之间由其他团队成员进行的代码审查也会提高代码的整体质量，因为他们能够发现被误解的需求。

## [](#packaging-and-deployment-to-the-teststaging-environment)打包并部署到测试/试运行环境

根据项目的类型，应用程序被构建、打包、发送到测试或试运行环境(模拟生产)。这确保了集成的更改与其他部分很好地构建在一起，并且可以部署以进行功能测试。在这个阶段，我们还要验证新的更改是否与其他库和部署环境兼容。这是阶段也应该自动化。

## [](#postdeployment-testing)部署后测试

对于需要部署应用程序的测试，CI 管道的这个阶段是它们运行的地方。测试因工具、框架和应用语言而异，但通常是功能集成和性能测试。这个阶段的成功执行结束了变更集的 CI 管道，表明它对用户来说足够好了。

一旦 CI 管道成功完成，部署的应用程序就可以接受“用户或 QA 团队”的手动测试，以确保它符合客户的要求。CI 管道生成的包或工件现在可以投入/部署到生产中。这也可以通过成功实施连续交付(CD)管道来实现自动化。

CI/CD 管道的成功实施有助于确保质量和提高速度，并使我们更接近连续交付。大多数源代码管理工具(如 Github、Bitbucket、Gitlab)要么有 CI pipeline 插件，要么可以很容易地与其他 CI/build 工具(如 Jenkins、Travis CI、CircleCI)集成。我个人的偏好是和詹金斯融合。希望这对你有用。期待看到这是如何在不同的项目中实现的。