# 服务人员的离线可访问性

> 原文:[https://dev . to/roelofjanelsinga/offline-accessibility-with-service-workers-1bl 1](https://dev.to/roelofjanelsinga/offline-accessibility-with-service-workers-1bl1)

[![Offline accessibility with service workers](img/ad1e6a7fcc5c579cae2cb3380a9a9ed1.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--buqIbZxg--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/8tev6nfayv4i2ynber3u.jpg)

# 服务人员的离线可访问性

网络应用很棒。它们很快，可以在所有平台上使用，并且经常感觉它们是一个真正的具有可访问性的本地应用程序。但是之后，你的网络停止工作，你只需要检查你之前做的小笔记。太糟糕了，你不能连接到应用程序，你也看不到你早些时候做的笔记 bummer！服务人员来救援了！

要真正让 web 应用程序与本地应用程序竞争，你需要模拟甚至增强这类应用程序的预期行为。这意味着应用程序应该感觉快速和响应，你应该能够随时随地访问它，它应该在你需要的时候让你受益。因此，让我们将这种预期行为分成三个部分:快速响应，随时随地可访问，以及个人利益。

## 反应敏捷

本机应用程序优于 web 应用程序的一个方面通常是本机应用程序感觉更快。你不需要等待某些东西出现在你的屏幕上，然而对于 web 应用程序，你经常需要等待数据来显示你的屏幕上的内容。这对很多人来说是一个交易破坏者。一个真正的 app 应该是快速的。解决这个问题的一个方法是通过 Nginx 或 Apache，通过 Cache-Control 进行浏览器缓存，并在您的响应头中过期。浏览器将尝试在浏览器中缓存所请求的资源，从而使应用程序的第二次加载几乎是即时的。这是令人惊奇的第一步，因为你的应用程序立刻感觉快了很多。然而，浏览器仍然需要从服务器请求数据来接收响应头，这在没有互联网的情况下是不可能的。这就是服务人员发挥巨大作用的地方。

## 随时随地都可以访问

我在上一段提到浏览器缓存是减少引导时间的一个很好的方法，但是如果你没有连接到互联网，它就不起作用。服务人员是这里的解决方案。服务人员本质上是内置于浏览器中的中间人。这个中间人可以拦截从浏览器到服务器的任何请求，并定制其行为。这听起来有点模糊，但坚持住。你要想象这个中间人正在接收你的请求(通过浏览器)。然后，worker 将在其内存中查看您以前是否请求过这些资源。这个资源可以是任何东西，从 JS 文件到 CSS 文件、HTML、图像等等。如果工作线程在内存中找到了资源，它将返回这个。你看到刚才发生了什么吗？该请求从未触及服务器。它请求了一些东西，服务工作者返回了所请求资源的缓存版本。您可以创建一个这样的 web 应用程序，即使您没有连接到互联网，它也是可用的。

离线访问只是服务人员的好处之一。
想象你在一个偏远的地方，你连接到互联网，
但你的连接速度慢得令人难以置信。通常情况下，当你离线时，网站不会立即加载，但这次不会。它会尝试下载所有的资源，就像平常一样，使用慢速连接。这会导致网站 3 分钟加载而不是 3 秒，这是很糟糕的用户体验。Tadaa！服务人员的另一项任务。这个小工人将认识到这种情况，并将返回缓存的版本，而不是试图从服务器请求资源。加载时间又是三秒！服务人员出去！

## 个人利益

离线 web 应用程序很棒，但如果你仍然需要互联网来保存数据，你的 web 应用程序仍然会失败。它看起来好像在工作，但实际上，除了漂亮和快速之外，它没有做任何其他事情。这里的解决方案对你们中的一些人来说可能不是最明显的，但是你可以利用 HTML5 的一个奇妙的特性，叫做 IndexedDB。这是一个浏览器内数据库，可以在一个简单的键值对数据库中包含 JSON 对象。当您的应用程序无法将任何数据保存到您的实际数据库中时，它可以使用 IndexedDB 作为离线后备，并在稍后您连接到互联网时与您的服务器同步。

这对你的应用意味着什么？这意味着它看起来很漂亮，速度很快，而且实际上功能齐全。这将使您的 web 应用程序越来越具有与本地应用程序的竞争力。首先，无论情况如何，您的应用程序都将像普通的本机应用程序一样运行。其次，不要告诉大家，构建 web 应用比构建原生应用要便宜和容易得多。这就是我所说的双赢。所以总结一下:使用服务人员使您的 web 应用程序在不太理想的情况下表现得更像本机应用程序。