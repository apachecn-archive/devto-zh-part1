# 终极优化

> 原文：<https://dev.to/craigbuchek/the-ultimate-optimization-1l5m>

我在 1984 年得到了我的第一台电脑。那是准将 64。我不得不做额外的家务，并攒下我的零花钱来买它。我当时 13 岁。

当时，西尔斯和其他零售店展出了 Commodore 64 电脑。每当我去商店，我都会写一个简短的 BASIC 程序，让它在展示电脑上运行

```
10 PRINT "CRAIG IS GREAT!"20 GOTO 10 
```

嘿，我那时才 13 岁。后来，我变得老练了一点。我会改变背景颜色。我还记得戳地址:

```
10 FOR I=0 TO 25520 POKE 53281, I30 NEXT I40 GOTO 10RUN 
```

这足够快速地每隔几行扫描就改变背景颜色，创造出闪烁的滚动效果。

后来学了 6502 汇编语言。我把基本程序翻译成汇编程序，并记住字节以便在商店输入。在汇编语言中，每扫描一行，背景颜色会改变几次。这种效果有点迷幻。

所有这些都发生在 20 世纪 80 年代中期。

快进到 2000 年左右。在圣路易斯的一次会议后，我讲述了上面的故事。我解释了我是如何记住了 10 或 12 字节的机器代码，并让程序带着迷幻效果继续运行。

想了一下，觉得 10 个或者 12 个字节好像太多了。这实际上困扰着我——我回到家时无法入睡。我起身找到了我的旧 6502 手册。我知道如何用 7 个字节写代码了。我在 Linux 桌面上安装了 Vice C64 模拟器，并测试了我的代码。它像预期的那样工作。(仿真器那时已经是时钟周期完美的了。)下面是汇编代码:

```
INX ; $E8 ; 232STX $D021 ; $8E $21 $D0 ; 142 33 208 ; $D021 = 53281JMP $C000 ; $4C $00 $C0 ; 76 0 192 ; $C000 = 49152 
```

下面是将程序存储在内存中并运行它的基本程序:

```
10 FOR N=49152 TO 49152+6: READ Q : POKE N, Q : NEXT20 DATA 232, 142, 33, 208, 76, 0, 19230 SYS 49152RUN 
```

这个故事的寓意是，即使是 10 字节的程序，在最后一次使用 15 年后，你也可以优化它。所以不要跟我说你的程序不能改进，再小也不行。

PS。我在 2015 年写这篇文章时重写了上面的代码，距离我上次重写大约 15 年。我再次下载 Vice 进行测试，这次是在 Mac OS X 上。