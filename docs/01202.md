# 100 天实践 TDD

> 原文:[https://dev.to/gonedark/100-days-practicing-tdd-4d5m](https://dev.to/gonedark/100-days-practicing-tdd-4d5m)

直到最近，我还在 [Humana DEC](http://www.humana.io) 的[极限编程团队](https://jason.pureconcepts.net/2015/05/two-weeks-extreme-programming/)工作。每个工作日我们都练习测试驱动开发(TDD)。100 天后，我想指出理论上的 TDD *和实践中的 TDD *的一些区别*。*

因此，关于 TDD 的三个定律，我有以下的警告:

1.  你不需要测试*所有的*
2.  你可以一次写多个失败
3.  你不需要在*纳米周期*练习 TDD
4.  您应该将设计决策推迟到蓝色阶段
5.  你也应该重构测试

在你按下屏幕之前，请允许我解释一下。

## [](#you-dont-need-to-test-everything)你不需要测试*一切*

理论上，根据 TDD 第一定律:

> 除非你先写了一个失败的测试，否则你不能写任何代码。

实际上，我很少为内容、设计、配置等编写测试。我为任何包含逻辑的代码编写测试。

## [](#you-can-write-more-than-one-failure-at-a-time)你可以一次写多个失败

理论上，根据 TDD 第二定律:

> 你不能写出比失败还多的测试。

在实践中，我经常一次写几个失败。然而，这些通常在相同的测试中，并且总是处于相同的水平。也就是一些单元测试失败或者一些集成测试失败。然后我让他们一个接一个地通过。

## [](#you-dont-need-to-practice-tdd-at-the-nano-cycle)在*纳米周期*不需要练 TDD

理论上，根据 TDD 第三定律:

> 你不能写超过足以通过当前失败测试的代码。

在实践中，当使用新的代码库或新技术时，我遵循 TDD 法则#2 和#3。一旦我熟悉了，我就编写失败的测试和代码，以便在一个周期内通过。我看没必要在*最小*配速<sup>[【1】](#footnote1)</sup>重复红绿循环。

## 你应该把设计决策推迟到蓝色阶段

理论上，正如 TDD 第三定律所指出的，绿色阶段是编写最少的代码来通过测试。

在实践中，许多人在绿色阶段(或更早)进行重构。这太早了。为了避免绿色阶段的重构，我几乎对所有事情都调用 [YAGNI](http://martinfowler.com/bliki/Yagni.html) 。将设计决策推迟到蓝色阶段。到那时，您将对代码和测试有更好的理解，以指导您的重构。

## 你也应该重构测试

理论上，*所有的*代码都应该重构。

实际上，测试很少被重构。测试也是代码，应该在蓝色阶段进行重构。此外，当实践 TDD 时，测试作为文档。因此，同样重要的是，如果不是更重要的话，确保测试代码能够清晰地交流。

* * *

<small>在写这篇文章的时候，我发现了鲍勃大叔的一篇文章，他在文章中讨论了[不同的 TDD 周期](http://blog.cleancoder.com/uncle-bob/2014/12/17/TheCyclesOfTDD.html)。上面的*理论*在*纳米循环*上运行。我所描述的*实际上*主要结合了*分钟*和后面的周期。</small>

* * *

***想要更多？**在 Twitter 上关注 [@gonedark](https://twitter.com/gonedark) ，获得每周编码提示、足智多谋的转发和其他随机信息。*