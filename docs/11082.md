# 代码审查与结对编程

> 原文:[https://dev . to/uday _ raya la/code-reviews-vs-pair-programming-560 I](https://dev.to/uday_rayala/code-reviews-vs-pair-programming-560i)

[![](img/724002622f685e3c3773906cc0e01eb0.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--uKxnsdlE--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AqeJ0VmSemcroGPakiuihcg.png)

[![](img/8240c708fe235d3306c2b5b24a350fc2.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--IkkIFYpg--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2ARWH6NqKGeRb9Vn_UgHv8QA.png) 

<figcaption>代码评审 vs 结对编程</figcaption>

我花了九年时间在团队中工作，这些团队严格遵循结对编程。我已经习惯了这种工作方式，也很欣赏它带来的好处。

在我的上一个项目中，我们没有机会一直进行结对编程。这要求我们进行代码审查，以确保我们交付的代码的质量。在我三个月的经验中，这篇文章试图总结进行代码评审而不是结对编程的优点和缺点。

#### 我们是怎么做到的？

我们使用 Github 作为我们的源代码库。主分支总是被认为包含生产就绪代码。每个故事都是在一个独立的分支上开发的，一个拉请求被创建、审查并合并回主文档。

我们使用 [git-reflow](https://github.com/reenhanced/gitreflow) 来促进代码审查。处理一个故事通常包括三个步骤:

*   **开始**——你在主人身上做一个`git reflow start`。这将使用主分支上的内容创建一个新分支。您可以继续在这个分支上工作，并且它不应该影响发布到生产的内容，因为只有主版本中的变更才会进入生产。我们的 CI(Teamcity)被配置为在创建的每个分支上运行构建。因此，当进行更改时，测试会运行并得到验证。
*   **评审** —在完成您的更改并亲自评审后，您可以通过运行`git reflow review`提出一个拉取请求。这将在 Github 上创建一个 pull 请求(PR)。然后，您可以要求您的任何团队成员或特定人员进行审核。他们会将自己的建议/意见作为内嵌意见放在 PR 上。你可以就是否需要任何改变进行对话。这通常在开发人员和评审人员之间来回传递。一旦所有要求的更改完成，审核者通过在 PR 上添加“LGTM”注释来标记 PR 可以合并。
*   **交付** —您现在可以将 PR 合并到主分支中。如果其他人已经合并并做了类似的更改，您可能会有冲突。成功合并之后，您必须确保预期的功能在 master 上工作，并且所有测试都通过。

你可以在以下文章中找到更多关于 git-reflow 的信息:

[https://guides.github.com/introduction/flow/](https://guides.github.com/introduction/flow/)

[http://scottchacon.com/2011/08/31/github-flow.html](http://scottchacon.com/2011/08/31/github-flow.html)

#### 升迁

*   **专家反馈** —尽管鼓励在敏捷团队中有更多的多面手，但拥有一些专家或在 CSS、数据库或 rails 等领域是专家的人通常是有利的。这样的设置有助于在合并之前获得他们对代码的反馈。这鼓励了知识共享。我发现这比让专家与团队的每个成员配对更具可扩展性。这也适用于初级开发人员多于高级开发人员的团队，他们可能需要对所写代码的反馈。
*   **不要霸占键盘** —结对编程作为一种分享知识的方式很有用。但是我看到有时候经验更丰富的人主导配对。虽然一开始分享知识是很好的，但它并不能帮助年轻人建立独立工作的信心。即使他们有机会在配对时导航，他们可能会感到一些压力，因为他们在浪费对方的时间来跟上他们的速度。当遵循代码评审时，初级人员可以自己处理故事。如果需要的话，他们可以得到偶尔的帮助，也可以在核心工作时间之外花更多的时间阅读，而不会为浪费他们的时间而感到内疚。他们最初可能会花更多的时间来讲述一个故事，但这有助于建立他们的信心。
*   **适合分布式团队** —我做过很多远程配对。尽管它工作得很好，但是您经常会遇到时区和带宽的挑战。由于带有拉请求的代码评审是异步完成的，它们也允许团队成员遵循对他们来说方便的工作时间。
*   **对话被存档** —拉式请求注释有助于某人了解为什么事情以后会以某种方式完成。
*   高度协作 —整个团队都可以看到代码评审中的对话。如果有什么我可以提供意见的，我可以加入对话。在结对编程中，当整个团队坐在一个地方，谈话可以被听到时，就会发生这种情况。但是对于分布式团队来说，这并不总是可能的。

#### 缺点

*   处理有依赖关系的故事很难——可能有一个正在进行的分支，你需要对其进行修改，但是你不能把它们放到你的分支上，因为它们还没有被合并到主分支中。这需要依赖故事的开发人员非常紧密地工作，并且需要大量的 git 合并和重新构建。
*   故事发展和回顾之间的时间间隔——这经常发生，因为人们忙于发展他们自己的故事。有时你需要多次跟进才能完成评估。
*   **复习大的变化很难** — 如果变化很多，就要花很多时间和精力去彻底复习。
*   **来自 CI 渠道的延迟反馈** —每个新分支的 CI 渠道仅在一个级别有效。如果您有一个在多个服务上运行端到端测试的二级构建，您不能在所有新的分支上运行它们。因此，反馈被延迟。

#### 结论

这并不意味着我们根本不应该进行结对编程。当你开始接触新的人或建立新的代码库时，配对仍然很有帮助。我觉得在遵循结对编程的团队中进行某种形式的代码审查仍然是有用的。但是要确保你的故事要小，不要以长寿的分支结束。

请在评论中加入你的想法。如果你喜欢这篇文章，推荐它，这样其他人就可以找到它并参与讨论。

* * *