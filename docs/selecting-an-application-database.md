# 选择应用程序数据库

> 原文：<https://dev.to/ggonchar/selecting-an-application-database>

选择数据存储技术我认为是必须做出的最重要的技术决策之一。错误选择的数据存储会使您无法满足软件需求。数据库的选择需要深思熟虑的设计和研究投资，应该尽最大的责任。在这里，我想分享我的知识和想法，如何为您的任务选择正确的数据库。

### 理解问题的难度

虽然有些应用程序需要存储数 Pb 的数据并在亚毫秒级处理它们，但其他应用程序可能需要简单的数据存储，这些数据可以放在笔记本电脑的内存中，并且可以等待几秒钟才可用。并非所有的应用都同样困难，技术选择也不同样重要。任务关键型系统需要深思熟虑的设计:功能比较、原型实现、性能测试，但并不是每个系统都需要这些步骤。对于简单的任务，你可以使用已经采用的技术。投入与问题价值相称的时间。

### 聚集需求

软件工程的一切都是从那里开始的。试着理解你的数据模型和你的应用程序与它交互的方式。尝试估计数据的大小。获取吞吐量和延迟要求。了解需要哪些一致性保证以及是否需要线性化。

### 默认考虑 SQL

今天，SQL 与 NoSQL 的较量不再是关于 SQL。PostgreSQL 或 MySQL 等传统 SQL 数据库已经支持 JSON 或其他格式的非结构化文档存储，而 NoSQL 数据库发展了查询语法，以达到接近 SQL 的功能。主要区别在于，SQL 数据库是默认为非分片设置构建的，只有一个写实例和几个读副本。这就是如何在没有繁重的 2PC 协议的情况下满足满 ACID 的方式。只有当 SQL 不能满足数据大小、吞吐量、延迟或查询能力方面的要求时，才考虑“30 年前的遗留”SQL 数据库。有了 SQL，您肯定可以查询几乎所有内容，并使数据在任何时候都是持久和一致的。如果需求会改变，或者如果您意识到您在数据模型上做了错误的假设，那么您是安全的。

### 任何更好的东西都伴随着价格

为了比 SQL 数据库做得更好，我们必须牺牲一些东西。通常，这包括一致性、持久性以及访问和操作数据的方式。需要更快地写入更多数据？不要立即写入磁盘或者不要立即更新索引。单个实例无法处理写入？消除文档之间的一致性，并将它们分布在整个集群中。想要通过按键更快地访问吗？更改数据存储方式，并删除一些查询功能。这些都是现实世界硬件限制造成的游戏规则。NoSQL 数据库优于 SQL 的每一个特性都是以牺牲一些 SQL 数据库功能为代价的。这里没有免费的午餐。

### 正确的问题包含答案

假设问题足够大或者足够具体。通过对问题进行分类，我们已经找到并回答了问题。需要存储键/值数据？查看键/值存储。写密集型工作负载？看看写优化的解决方案。想储存关系？查看图形数据库。但前提是你的问题足够大或足够具体。

### CAP 分类没那么有帮助

虽然 CAP 定理对数据库进行 CP、AP、CA 分类是绝对有效的，但它通常是无效的。大多数 NoSQL 数据库都可以调整到所需的一致性级别。更侧重于理解数据库架构以及它通常解决哪些问题和用例。寻找他人的经验。

### 不要完全相信营销

根据白皮书，每个数据库都是世界上最好、最快、最可靠的。没有人会在主页或白皮书中写限制。它们通常隐藏在文档中，甚至隐藏得如此之深，以至于公开它们会让许多人感到惊讶。Kyle Kingsbury 的 Jepsens 是在实践测试中探索数据库局限性的一个很好的例子。衡量不信任。基准测试是件棘手的事情。您可以找到一个数据库 X 优于数据库 Y 的基准测试，以及另一个数据库 Y 优于数据库 X 的基准测试。

### 了解免费版的局限性

我说不出任何一个受欢迎的数据库背后没有公司赚钱。即使是那些在脸书和谷歌等公司诞生和开源的技术，也已经有咨询公司和公司提供商业版本。更棘手的是因 NoSQL 趋势而诞生的数据库。它们是由利用这些技术赚钱的公司开发的，这是公平的。这就是为什么免费版可能会非常受限，迫使你为商业版付费。了解所选版本的局限性。它们通常包括安全性、复制、监控、错误修复，对许多系统都至关重要。在项目的早期就这样做，并与预算保持一致。

### 了解托管选项的限制

有许多数据库作为服务提供，如 Heroku 附加组件。您不必处理基础架构、复制设置和备份。开始实现应用程序的一切都准备好了。通常托管数据库比裸机更贵，因为裸机可以通过许可证安装任何数据库。但价格差异并不是唯一的成本。数据库维护即服务使您无法直接使用某些管理功能。这意味着您可能无法创建具有不同权限的多个用户，安装扩展，甚至无法更改持久性/一致性级别。您肯定会得到数据库通信协议的兼容性，但不是所有的特性。仔细评估这些限制。

### 是时候上场了

经验很重要。团队内部的知识很重要。旧的和已知的比新的和未知的好。异质性带来复杂性。分布式系统是艰难的。建立数据库是困难的。一切旧的和经过考验的东西都比新的和花哨的好。尝试新技术总是有风险的。同时尝试多种新技术风险很大。不是每个任务和环境都允许冒这个险。了解你是否可以允许自己尝试新技术，这应该比已经使用和采用的技术更好。但并不是每个问题都是你可以用锤子钉起来的钉子。没有“最好的”数据库。可能有一个最适合你的问题。