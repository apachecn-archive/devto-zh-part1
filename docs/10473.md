# 使用软件，你会看到它的好处！

> 原文:[https://dev . to/roelofjanelsinga/use-software-for-what-it-s-made-and-you-ll-see-the-benefits-396 l](https://dev.to/roelofjanelsinga/use-software-for-what-it-s-made-and-you-ll-see-the-benefits-396l)

[![Archive](img/7af8348488e00887d60d666ffbbc40b1.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--BCshdtUZ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/v13iobawrkc13vks3ihx.jpg)

# 将软件用于它的用途，你会看到它的好处！

你！是的，你在那里！您还在使用 SQL 查询在数据库中执行搜索请求吗？你怎么样了？它没有你预期的那么快对吗？这就是为什么我决定从在关系数据库中使用 SQL 查询转换到一个为搜索而设计的软件:Solr 的主要问题。不要误解我的意思，如果您有非常具体的搜索需求，SQL 查询或对任何 NoSQL 数据库的请求都是非常好的。例如:查找属于该特定唯一标识符的记录。这是一个很好的解决方案。然而，当您的数据库开始增长时，属于这个特定惟一标识符的文档数量增加，并且必须对关系数据库执行更多的连接操作，您将开始发现瓶颈。

### 什么问题？

尤其是 JOIN 操作，对我来说是一个问题，需要过滤的大量数据破坏了我的搜索性能。通常在接收任何数据之前必须等待 10 秒或更长时间。我的第一个解决方案是在我的 SQL 数据库中创建一个巨大的平面表。我的想法是消除连接查询以提高性能。这几个月来工作得非常好，它从大约 5000 条记录开始，至少可以说这是一个简单的任务。然而，几个月后，这个表慢慢增长到 200，000 多条记录。在这一点上，我发现性能略有下降，每个请求从 2 秒下降到 4-6 秒。这肯定比以前少，但对我来说太慢了。当我不得不实现产品的实时定价时，我最终决定做出改变。这意味着实时计算折扣、用户信用和一系列其他东西...数以千计的记录。你可以想象这是多么大的打击。我的搜索请求时间从 4-6 秒到 45 秒。在这一点上，我停下来，退后一步，并决定使用两个不同的系统，每个系统都是为其服务的目的而设计的。关系数据库用于保存数据，保持数据的良好结构，Solr 用于索引文档并使其可搜索。

### 解

现在，如果你了解我，你会知道我不是活着的最技术化的程序员。我知道如何做每件事的一点点，但并不是所有的都是最好的。然而，我是一个不轻易放弃的人。开始学习如何设置 Solr 和 Solaris(PHP 库)绝对不是一件容易的事情。在我看来，我错过了很多我习惯的文档。我每天都使用 Laravel 和 Laravel Lumen，这些 PHP(微)框架都有很好的文档记录。从整个过程开始，我建立了一个虚拟的 Ubuntu 盒子。我已经熟悉了 Java 编程语言(Solr 就是基于这种语言构建的)，所以至少我不是完全一无所知。总之，我建立了 Solr 服务器，并创建了我的第一个集合。这花了我大约 4 个小时，因为我找不到它的命令，并一直试图在浏览器中使用 GUI。不过，在我找到它的指令后，我就开始了飞速的前进。我为它设置了用户名和密码，然后开始使用 Solarium。

Solarium 是一个 PHP 库，用于与 Solr 服务器交互。这很容易通过 Composer 安装。Laravel 本身的配置也非常简单，我在 30 分钟内就与我的 Solr 服务器建立了工作连接。但是之后我不得不在这个全新的 Solr 服务器上填充数据来建立索引。我按照 Solarium 文档进行了努力。这是一个有用的指南，但它可以更广泛地真正帮助刚开始使用图书馆的人。然而，一旦我最终获得了第一个被索引的文档，就很容易创建新的集合并用文档填充它们。

### 值得吗？

所以你可能会想，这很好，但是它真的对你的项目有帮助吗，值得吗？回答这个问题:是的，它确实帮助了我的搜索性能。我从 45 秒到 600 毫秒- 1.8 秒。相当惊人的性能提升，对不对？这值得吗？绝对的！除了对普通搜索请求的惊人速度之外，您还可以非常容易地创建方面、应用过滤器、分组文档等。这意味着我可以用 Solr 中的内置过滤来代替 PHP 中的大部分手动过滤，进一步改善搜索体验。Solr 自动对文档进行排序，因此最相关的文档将显示在顶部。以前，我必须手动完成所有这些工作，因为我的相关文档严重依赖于请求位置和产品之间的距离。Solr 会动态地为您完成所有这些工作。当然，这带来了大量搜索查询形式的配置，但可能性实际上是无限的。

我很高兴我做出了改变。它不仅加快了搜索速度，还帮助分析数据、创建报告以及加快应用程序不同部分的速度。除了速度上的明显提升，它还减轻了我的服务器负载。巨大的 SQL 查询给我的服务器带来了压力，部分原因是我自己的无能，但也是因为更大的数据集。Solr 减轻了服务器的压力，所以现在它可以专注于更重要的事情，比如帮助用户在应用程序中获得良好的体验。所以，如果你面临同样的问题，一定要试一试 Solr，看看它是否像对我一样对你有益！