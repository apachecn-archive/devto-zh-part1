# 我建立了自己的发票系统

> 原文:[https://dev.to/michael/i-built-my-own-invoicing-system](https://dev.to/michael/i-built-my-own-invoicing-system)

大约一周前，我收到了一封来自我使用的发票服务的电子邮件，我使用了多年的免费层正在逐步淘汰，我必须升级到付费层。包月费是每月 15 美元。我一个月最多开两张发票，前提是我很勤奋，没有拖欠发票。

我无法证明支付这个价格是合理的，因为每次我开发票时，我所做的只是改变三样东西。在幕后，我肯定这项服务为我做了很多，但我真的需要它来生成我的发票的 PDF 版本，并通过电子邮件发送给我的客户。

不幸的是，作为一名程序员，我经常遇到这种情况。当我看到一项服务并对自己说，我可以自己做。我考虑了一下服务，提取了一小部分我需要自己的发票生成器来做的事情。我需要它接收数据并生成 HTML 发票。从那里我可以打开 HTML 发票并从 Chrome 生成 PDF。

我约束自己只花两个小时来建造这个东西。但是我确实想知道这是不是产生发票的最有效的方法。毕竟，根据我目前的咨询价格，支付服务费用可能比花几个小时拼凑一个解决方案更具成本效益。

我的另一个想法是，为什么不用文字处理器来生成发票呢？现在想起来，不确定为什么没有。我想我需要创造一些东西，这种需要压倒了我看到更简单的解决方案的能力。

最后还有一个问题，就是不支持其他有创造力的人。作为一个制造东西的人，当东西为他人提供价值时，我肯定希望得到报酬。这很奇怪，因为我又不能证明为服务付费是合理的。这是因为相对于它的价格，它的使用频率很低。我想这就是免费提供东西的危险。我为服务付费的价值体系完全被打乱了。

以网飞为例，我每月支付 8 美元。但在我妻子、孩子们和我之间，它每天都被用来娱乐，很容易卖出去。相比之下，我一个月最多用两次 15 美元的服务，我就是付不起钱。我认为这也可以归结为一个事实，我不能再造网飞，但我可以再造发票服务。

所以昨晚我开始创建我的发票解决方案。我没有限制自己的两个小时，而是花了将近四个小时。搞清楚投入和产出并不是那么糟糕，实际上是让发票看起来体面，这要花很多时间。

我最终选择了一个节点和 JavaScript 解决方案，因为[使用了你所拥有的](https://michaelsoolee.com/what-you-got/)。工作流程是这样的，每当我想生成一个新的发票时，我复制一个包含发票所有数据的 TOML 文件。然后我通过我的节点脚本运行它，该脚本解析 [TOML](https://github.com/toml-lang/toml) 并生成数据的 JSON 表示。JSON 然后被传递给 Handlebars 模板，该模板获取数据并生成发票的布局。然后，布局被保存为 HTML 文件。从那里我可以在 Chrome 中打开 HTML 文件并生成 PDF。

付费发票服务提供给我的是一个数据库，可以记录我所有发票的历史记录。正是因为这个原因，我决定用 TOML 文件。我可以复制这些文件，并在我的[收存箱](https://db.tt/I0b2M11p)中同步它们。这并不奇怪，因为我在 Dropbox 上同步的所有笔记都是纯文本文件。

[![Example TOML data](../Images/9e6c2905d154d908ca47b52e1445cc39.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--_u7Uoymc--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/vp31nv6l88a1qmihhbl7.png)

这实际上是我第一次使用 TOML，我更熟悉 YAML。虽然我本来可以使用 JSON，但是我决定使用 TOML，因为它的语法很简洁。有了 TOML，我不用担心逗号和花括号。作为一名开发人员，这也引起了我的共鸣，因为这是我熟悉的东西。这就像我第一次看到 [dev.to 的](https://dev.to)帖子编辑器一样，它支持 markdown，但更重要的是，它看起来就像你在 Jekyll 中找到的帖子。有一部分是头版的内容，然后是实际文章的内容。我第一次看到那个的时候完全被吓呆了。

将来我可能会扩展这个工具，使它可以和 YAML 互换。我可能会做的另一件事是将一个过程与 PhantomJS 集成，以自动为我生成 PDF，而不是手动获取 HTML 并在 Chrome 中生成 PDF。这将减少几个步骤，使过程更加容易。但是现在，发票生成工作，我认为我已经完成了我的计划，节省了钱，并推出了我自己的发票系统。它满足了我书呆子的一面，因为它采用 TOML 并生成 PDF 发票。

[![Final rendered PDF with invoicing system](../Images/84162535b8c0abd6cf089d930897bc49.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--jbw_LtqK--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/vzocmgfbvfgu5q03to6u.png)

* * *

最初发布于[李名炀](https://michaelsoolee.com/my-invoicing/)