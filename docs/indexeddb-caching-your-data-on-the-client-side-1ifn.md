# IndexedDB:在客户端缓存数据

> 原文：<https://dev.to/roelofjanelsinga/indexeddb-caching-your-data-on-the-client-side-1ifn>

[![IndexedDB](img/fa7b5506f0cd2dd4c8fec953602e1bb5.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--jRYwnXgU--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/iiym2ijrao6c3qqh59pm.jpg)

# IndexedDB:在客户端缓存您的数据

几个月前，我开始在浏览器中保存数据。这不是因为性能原因，而是因为功能原因。我使用 LocalStorage 来保存需要随时供 web 应用程序和用户使用的数据，甚至在简单的刷新之后。这在很长一段时间内运行得非常完美，直到应用程序变得越来越大。此时，我的每个视图有 5 到 10 个 XHR 请求。这在 2 或 3 岁的时候很容易实现。大多数页面使用相同的数据，相同的不变数据。这是我开始考虑缓存所有这些数据，让用户体验更好，因为应用程序加载速度会更快。不仅用户受益，而且服务器收到的请求也更少，从而为并发用户提供更好的性能。

### 为什么没有 localStorage？

那么，为什么本地存储不再好了呢？这有两个简单的原因。首先，储物空间有限。LocalStorage 数据只能保存为字符串。在错误开始发生之前，字符串长度只能有这么长。另一方面，IndexedDB 将数据保存为实际对象。这样，数据可以立即在应用程序中使用。除了将数据保存为对象而不是字符串之外，IndexedDB 还是异步的。这很重要，因为它不会阻塞 DOM。当处理较大的任务时，不阻塞 DOM 是很重要的，并且您不想让用户对无响应的应用程序感到困惑。LocalStorage 和 SessionStorage 都是同步的，确实会阻塞 DOM，但是它们不应该用于更大的任务。IndexedDB 更适合这个任务。

### 为什么要在客户端缓存数据？

但是为什么要使用 IndexedDB 呢？这难道不是你在开发应用程序时需要注意的另一层吗？当然，但是也要看看它能为你，为你的开发者，为你的服务器，为你的用户做些什么。如果操作正确，您可以利用 IndexedDB 来缓存所有传入的“静态”数据。这样做的结果是，您只需加载一次特定的资源。当您从服务器加载它时，您可以保存它，并在下次需要时使用保存的资源。这实现了两件事。第一，你的服务器不需要接受单个用户的重复请求。第二，请求的页面将更快地加载，因为对服务器的请求不再是必要的，并且资源已经保存到 RAM 存储器中。这将有利于您的应用程序的用户体验。

如果你使用 localStorage、IndexedDB 或者什么都不用，让应用程序尽可能高效是非常重要的。这对你的用户很重要，对你的服务器也很重要。没有什么比服务器过载或导致糟糕的用户体验更糟糕的了。无论你做什么，一定要做好。如果这意味着您将需要使用缓存解决方案，如 localStorage、sessionStorage 或 IndexedDB (WebSQL 已被否决，不要使用它),请选择最适合您需求的解决方案。您是否需要一些简单的东西，比如让视图之间的数据保持接近？尝试使用 localStorage 或 sessionStorage。它非常适合小任务。如果您需要一个更复杂的缓存解决方案，能够保存更大的数据集，并且不会阻塞 DOM，那么 IndexedDB 正是您应该使用的。为了更好地实现这一点，将它与服务人员结合使用，您就可以创建一个 web 应用程序，它不仅在您在线时可用，而且在您没有任何互联网连接时也可用。